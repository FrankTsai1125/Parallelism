â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ”¬ æ·±åº¦åˆ†æï¼šå¦‚ä½•å‡å°‘ Pyramid æ„å»ºæµªè´¹
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“Š é—®é¢˜é‡è¿°

å½“å‰æƒ…å†µï¼š
- n=2: Rank 0 æ„å»º 8 octaves ä½†åªç”¨ octave 0 â†’ æµªè´¹ 87.5%
        Rank 1 æ„å»º 8 octaves ä½†åªç”¨ octaves 1-7 â†’ æµªè´¹ 12.5%
        æ€»æµªè´¹: 50%

- n=4: Rank 0 æ„å»º 8 octaves ä½†åªç”¨ octave 0 â†’ æµªè´¹ 87.5%
        Rank 1 æ„å»º 8 octaves ä½†åªç”¨ octaves 1-3 â†’ æµªè´¹ 62.5%
        Rank 2 æ„å»º 8 octaves ä½†åªç”¨ octaves 4-5 â†’ æµªè´¹ 75%
        Rank 3 æ„å»º 8 octaves ä½†åªç”¨ octaves 6-7 â†’ æµªè´¹ 75%
        æ€»æµªè´¹: 75%

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ” æ€è€ƒ 1: ç†è§£ Octave ä¾èµ–å…³ç³»

### Gaussian Pyramid æ„å»ºæµç¨‹åˆ†æï¼š

```
åŸå›¾ (1000x1000)
  â†“ resize 2x + gaussian_blur
Octave 0 base (2000x2000)
  â†“ gaussian_blur å¤šæ¬¡
Octave 0 scales[0..5] (2000x2000 Ã— 6 images)
  â†“ å– scale[3]ï¼Œresize 0.5x
Octave 1 base (1000x1000)
  â†“ gaussian_blur å¤šæ¬¡
Octave 1 scales[0..5] (1000x1000 Ã— 6 images)
  â†“ å– scale[3]ï¼Œresize 0.5x
Octave 2 base (500x500)
  â†“ ...
```

### å…³é”®å‘ç°ï¼š

1. **Octave i ä¾èµ– Octave i-1**
   - Octave i çš„ base image = resize(Octave i-1 çš„ scale[3])
   - è¦æ„å»º octave 3ï¼Œå¿…é¡»å…ˆæœ‰ octave 2 çš„ scale[3]
   - è¦æ„å»º octave 2 çš„ scale[3]ï¼Œå¿…é¡»å…ˆæœ‰ octave 2 çš„ base
   - ... é€’å½’åˆ° octave 0

2. **ä¸éœ€è¦æ‰€æœ‰ scales**
   - å¦‚æœåªéœ€è¦ octave 3ï¼Œä¸éœ€è¦ octave 0-2 çš„æ‰€æœ‰ 6 ä¸ª scales
   - åªéœ€è¦æ¯ä¸ª octave çš„ scale[3]ï¼ˆç”¨äºç”Ÿæˆä¸‹ä¸€ä¸ª octaveï¼‰

3. **Octave 0 æ˜¯ç‰¹æ®Šçš„**
   - å®ƒä»åŸå›¾ç›´æ¥ç”Ÿæˆï¼Œä¸ä¾èµ–å…¶ä»– octave
   - å®ƒæ˜¯æœ€å¤§çš„ï¼Œå æ® 75% çš„å·¥ä½œé‡

### ç»“è®ºï¼š
âŒ ä¸èƒ½å®Œå…¨è·³è¿‡ä¸éœ€è¦çš„ octaves
âœ“ ä½†å¯ä»¥åªæ„å»ºå¿…è¦çš„ scalesï¼ˆç”¨äºç”Ÿæˆåç»­ octavesï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ’¡ æ€è€ƒ 2: ä¸‰ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ A: æŒ‰éœ€æ„å»º - åªæ„å»ºéœ€è¦çš„ Octaves åŠå…¶å‰é©±

**ç­–ç•¥**:
- Rank éœ€è¦ octaves k..m
- æ„å»º octaves 0..mï¼Œä½†ï¼š
  * Octaves 0..k-1: åªæ„å»ºåˆ° scale[3]ï¼ˆç”¨äºç”Ÿæˆä¸‹ä¸€ä¸ª octaveï¼‰
  * Octaves k..m: æ„å»ºå®Œæ•´çš„ scalesï¼ˆç”¨äº SIFT å¤„ç†ï¼‰

**ç¤ºä¾‹ (n=2)**:
- Rank 0 éœ€è¦ octave 0:
  * æ„å»º octave 0 çš„å®Œæ•´ scales[0-5] âœ“
  
- Rank 1 éœ€è¦ octaves 1-7:
  * æ„å»º octave 0 çš„ scale[0-3]ï¼ˆåªåˆ° scale[3]ï¼‰
  * æ„å»º octaves 1-7 çš„å®Œæ•´ scales âœ“

**æ”¶ç›Š**:
- Rank 0: æ— èŠ‚çœï¼ˆéœ€è¦å®Œæ•´ octave 0ï¼‰
- Rank 1: èŠ‚çœ octave 0 çš„ scale[4-5] â†’ çº¦èŠ‚çœ 33% çš„ octave 0 æ„å»º
- æ€»èŠ‚çœ: ~6% (å› ä¸º octave 0 å  75%ï¼ŒèŠ‚çœå…¶ 33% å³ 25%)

**é—®é¢˜**:
âœ— æ”¶ç›Šè¾ƒå°ï¼ˆåªèŠ‚çœ 6%ï¼‰
âœ— å®ç°å¤æ‚
âœ— éœ€è¦ä¿®æ”¹æ ¸å¿ƒç®—æ³•

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

### æ–¹æ¡ˆ B: Pipeline æ„å»º - Rank 0 å…ˆæ„å»ºå¹¶å¹¿æ’­ Base Images

**ç­–ç•¥**:
- Rank 0 æ„å»ºæ‰€æœ‰ octaves çš„ base images (scale[0])
- å¹¿æ’­ base images ç»™å…¶ä»– ranks
- æ¯ä¸ª rank ä»æ”¶åˆ°çš„ base image å¼€å§‹æ„å»ºè‡ªå·±éœ€è¦çš„ scales

**ç¤ºä¾‹ (n=2)**:
1. Rank 0: æ„å»º octave 0-7 çš„ base images
2. Rank 0 å¹¿æ’­ octave 1-7 çš„ base images â†’ Rank 1
3. Rank 0: ä» octave 0 base æ„å»ºå®Œæ•´ scales
4. Rank 1: ä»æ”¶åˆ°çš„ bases æ„å»º octaves 1-7 çš„å®Œæ•´ scales

**æ”¶ç›Š**:
- Rank 1 ä¸éœ€è¦æ„å»º octave 0 çš„ä»»ä½•å†…å®¹
- èŠ‚çœ: octave 0 çš„é‡å¤æ„å»º

**é—®é¢˜**:
âœ— MPI é€šä¿¡å¼€é”€å·¨å¤§
  * Octave 0 base: 2000x2000 = 16MB
  * Octave 1 base: 1000x1000 = 4MB
  * Octave 2 base: 500x500 = 1MB
  * ... æ€»è®¡ ~20MB ä¼ è¾“
âœ— Rank 1 å¿…é¡»ç­‰å¾… Rank 0 å®Œæˆæ„å»º
âœ— å¢åŠ åŒæ­¥ç‚¹ï¼Œå¯èƒ½é™ä½å¹¶è¡Œåº¦

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

### æ–¹æ¡ˆ C: æ··åˆç­–ç•¥ - åªä¼˜åŒ– Octave 0

**ç­–ç•¥**:
- è®¤è¯†åˆ° octave 0 å  75% å·¥ä½œé‡
- å¯¹ octave 0 ç‰¹æ®Šå¤„ç†
- Octaves 1-7 ç›¸å¯¹å°ï¼Œå¯ä»¥æ¥å—é‡å¤æ„å»º

**å…·ä½“åšæ³• (n=2)**:
- Rank 0: æ„å»ºå®Œæ•´ octave 0
- Rank 0: å¹¿æ’­ octave 1 çš„ base image â†’ Rank 1
- Rank 1: ä»æ”¶åˆ°çš„ base æ„å»º octaves 1-7
- Rank 1: ä¸æ„å»º octave 0

**æ”¶ç›Š**:
- Rank 1 å®Œå…¨è·³è¿‡ octave 0ï¼ˆå  75% å·¥ä½œï¼‰
- é€šä¿¡å¼€é”€: åªæœ‰ octave 1 base (4MB)

**é—®é¢˜**:
âš ï¸ Rank 1 éœ€è¦ octave 1 baseï¼Œä½† octave 1 base æ¥è‡ª octave 0
âš ï¸ ä»ç„¶éœ€è¦ Rank 0 å…ˆå®Œæˆéƒ¨åˆ†å·¥ä½œ
âš ï¸ å¢åŠ åŒæ­¥ç‚¹

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ¤” æ€è€ƒ 3: æ·±å…¥è¯„ä¼° - å®é™…å¯è¡Œæ€§å’Œæ€§èƒ½åˆ†æ

### å…³é”®çº¦æŸï¼š

1. **ä¾èµ–å…³ç³»ä¸å¯é¿å…**
   - Octave i å¿…é¡»ä» octave i-1 ç”Ÿæˆ
   - æ— æ³•çœŸæ­£"è·³è¿‡"å‰é¢çš„ octaves

2. **é€šä¿¡ vs è®¡ç®—æƒè¡¡**
   - MPI é€šä¿¡å»¶è¿Ÿï¼š~1-10 ms
   - ä¼ è¾“ 4MBï¼š~5-20 ms (å–å†³äºç½‘ç»œ)
   - æ„å»º octave 0ï¼š~1000 ms
   - æ„å»º octave 1ï¼š~250 ms
   
   ç»“è®º: é€šä¿¡ç›¸å¯¹ä¾¿å®œï¼Œå¦‚æœèƒ½é¿å…å¤§é‡è®¡ç®—

3. **åŒæ­¥å¼€é”€**
   - Pipeline æ–¹æ¡ˆå¼•å…¥åŒæ­¥ç‚¹
   - Rank 1 å¿…é¡»ç­‰å¾… Rank 0
   - å¯èƒ½é™ä½å¹¶è¡Œåº¦

4. **å®ç°å¤æ‚åº¦**
   - ä¿®æ”¹æ ¸å¿ƒç®—æ³•é£é™©é«˜
   - è°ƒè¯•å›°éš¾
   - å¯èƒ½å¼•å…¥ bugs

### æ€§èƒ½æ¨¡å‹åˆ†æ (n=2)ï¼š

**å½“å‰æ–¹æ¡ˆ**:
```
Rank 0: æ„å»º octaves 0-7 (1000ms) + å¤„ç† octave 0 (X ms)
Rank 1: æ„å»º octaves 0-7 (1000ms) + å¤„ç† octaves 1-7 (Y ms)
æ€»æ—¶é—´: max(1000+X, 1000+Y) = 1000 + max(X, Y)
```

**æ–¹æ¡ˆ C (ä¼˜åŒ– octave 0)**:
```
Rank 0: æ„å»º octaves 0-7 (1000ms) + å¤„ç† octave 0 (X ms)
        å¹¿æ’­ octave 1 base (5ms)
Rank 1: ç­‰å¾… octave 1 base (750ms + 5ms)
        æ„å»º octaves 1-7 (250ms) + å¤„ç† octaves 1-7 (Y ms)
æ€»æ—¶é—´: max(1000+X+5, 755+250+Y) = max(1005+X, 1005+Y)
```

**åˆ†æ**:
- å¦‚æœ X â‰ˆ Y: æ— æ€§èƒ½æå‡ï¼
- åŸå› : Rank 1 çš„ç­‰å¾…æ—¶é—´ (755ms) + æ„å»ºæ—¶é—´ (250ms) â‰ˆ åŸæ„å»ºæ—¶é—´ (1000ms)
- ç»“è®º: âŒ æ–¹æ¡ˆ C åœ¨ n=2 æ—¶æ”¶ç›Šä¸å¤§

**æ–¹æ¡ˆ A (æŒ‰éœ€æ„å»º)**:
```
Rank 0: æ„å»º octave 0 å®Œæ•´ (750ms) + å¤„ç† octave 0 (X ms)
Rank 1: æ„å»º octave 0 éƒ¨åˆ† (250ms) + æ„å»º octaves 1-7 (250ms)
        + å¤„ç† octaves 1-7 (Y ms)
æ€»æ—¶é—´: max(750+X, 500+Y)
```

**åˆ†æ**:
- èŠ‚çœ: Rank 1 çš„ octave 0 æ„å»ºä» 750ms â†’ 250ms
- å¦‚æœ Y > X + 250: æ— æ€§èƒ½æå‡ï¼ˆRank 1 æ˜¯ç“¶é¢ˆï¼‰
- å¦‚æœ Y < X + 250: èŠ‚çœ ~250ms

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ’ æœ€ç»ˆç»“è®º

### æ®‹é…·çš„äº‹å®ï¼š

1. **Octave ä¾èµ–å…³ç³»é™åˆ¶äº†ä¼˜åŒ–ç©ºé—´**
   - æ— æ³•å®Œå…¨è·³è¿‡ä¸éœ€è¦çš„ octaves
   - æœ€å¤šåªèƒ½å‡å°‘ scales çš„æ•°é‡

2. **Octave 0 å ä¸»å¯¼åœ°ä½ (75%)**
   - ä¼˜åŒ–å…¶ä»– octaves æ”¶ç›Šæœ‰é™
   - ä½† octave 0 åˆæ˜¯æ‰€æœ‰ octaves çš„åŸºç¡€

3. **é€šä¿¡å¼€é”€å¯èƒ½æŠµæ¶ˆæ”¶ç›Š**
   - Pipeline æ–¹æ¡ˆå¼•å…¥åŒæ­¥å’Œé€šä¿¡
   - å¯èƒ½å¾—ä¸å¿å¤±

4. **å®ç°å¤æ‚åº¦é«˜**
   - éœ€è¦é‡å†™æ ¸å¿ƒç®—æ³•
   - é«˜é£é™©

### æ€§èƒ½åˆ†æç»“è®ºï¼š

**æœ€ä½³åœºæ™¯ (n=4)**:
- æ–¹æ¡ˆ A å¯èƒ½èŠ‚çœ ~10-20% æ€»æ—¶é—´
- å‰æ: è´Ÿè½½å‡è¡¡è‰¯å¥½
- é£é™©: ä¸­ç­‰

**ä¸€èˆ¬åœºæ™¯ (n=2)**:
- æ–¹æ¡ˆ A å¯èƒ½èŠ‚çœ ~5-10% æ€»æ—¶é—´
- æ”¶ç›Šæœ‰é™
- é£é™©: ä¸­ç­‰

### å»ºè®®ï¼š

ğŸš« **ä¸å»ºè®®å®æ–½ Pyramid ä¼˜åŒ–**

ç†ç”±ï¼š
1. æ”¶ç›Šæœ‰é™ (5-20%)
2. å®ç°å¤æ‚åº¦é«˜
3. é£é™©ä¸­ç­‰åˆ°é«˜
4. å¯èƒ½å¼•å…¥ bugs
5. è°ƒè¯•å›°éš¾

**æ›´å¥½çš„é€‰æ‹©**:
âœ“ å…ˆå®æ–½ä½é£é™©ä¼˜åŒ– (æ¶ˆé™¤ DoG æ‹·è´, MPI éé˜»å¡é€šä¿¡)
âœ“ å¦‚æœè¿™äº›ä¼˜åŒ–åä»éœ€æ›´å¤šæå‡ï¼Œå†è€ƒè™‘ Pyramid ä¼˜åŒ–

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## ğŸ“ å¦‚æœä¸€å®šè¦å®æ–½ï¼Œæ¨èæ–¹æ¡ˆ A (ç®€åŒ–ç‰ˆ)

### ç®€åŒ–çš„æŒ‰éœ€æ„å»ºï¼š

åªä¼˜åŒ–ä¸€ä¸ªç‚¹ï¼š**ä¸åŒ ranks æ„å»ºä¸åŒæ·±åº¦çš„ octave 0**

```cpp
ScaleSpacePyramid generate_gaussian_pyramid_partial(
    const Image& img, 
    float sigma_min,
    int num_octaves, 
    int scales_per_octave,
    int first_full_octave  // ç¬¬ä¸€ä¸ªéœ€è¦å®Œæ•´æ„å»ºçš„ octave
);
```

é€»è¾‘ï¼š
- Octaves < first_full_octave: åªæ„å»ºåˆ° scale[3]
- Octaves >= first_full_octave: æ„å»ºå®Œæ•´ scales

ç¤ºä¾‹ (n=2):
- Rank 0: first_full_octave=0 â†’ å…¨éƒ¨æ„å»º
- Rank 1: first_full_octave=1 â†’ octave 0 åªåˆ° scale[3]

é¢„æœŸæ”¶ç›Š: ~5-10%
é£é™©: ä¸­ç­‰
å·¥æ—¶: 2-3 å°æ—¶

